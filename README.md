# WB_SQL_Home_Work
HW
1.	Может ли быть в таблице реляционной базы данных несколько строк с повторяющимся PK? Почему?

1.1.	Нет, не может

1.2.	Одно из требований к реляционной БД – уникальность кортежей(строк) в ней, т.е. должна быть возможность единственным образом идентифицировать каждую строку таблице. Именно для этих целей создается столбец с первичным ключом. Соответственно первичный ключ по определению не может повторяться

2.	К какому типу относится субд Redis? В чем особенность данной субд при работе с памятью?

2.1.	 СУБД Redis относится к типу NoSQL и предоставляет механизмы для хранения данных в формате ключ-значение. Redis не поддерживает SQL-запросы и схему таблиц, как это делают реляционные базы данных.
2.2.	 Особенности работы с памятью
Работа в памяти: Redis хранит все данные в оперативной памяти (RAM), что обеспечивает высокую скорость доступа и обработки данных по сравнению с дисковыми базами данных. 
	Персистентность данных: несмотря на то что Redis хранит данные в памяти, он также предлагает механизмы для сохранения данных на диск, чтобы обеспечивать персистентность данных и восстанавливать их после перезагрузки системы.
	Атомарные операции: Redis поддерживает атомарные операции на сложных типах данных, что позволяет реализовывать высокоуровневые, атомарные операции в самой базе данных.
	Репликация: поддержка master-slave репликации, позволяющая реализовать стратегии для улучшения производительности и отказоустойчивости.
	Поддержка TTL (Time-To-Live): Redis позволяет устанавливать время жизни для данных, что делает его идеальным выбором для реализации кэширования данных.
	Поддержка LRU: при достижении лимита памяти Redis может автоматически удалять наименее используемые ключи, используя алгоритм LRU (Least Recently Used) или аналогичные стратегии.
	Высокая производительность: благодаря использованию памяти и оптимизированной однопоточной модели, Redis способен обрабатывать миллионы запросов в секунду.
3.	
3.1.	В MongoDB -  представитель NoSQL баз данных:
Аналогом таблицы в реляционных СУБД является коллекция.

3.2.	Аналогом строки/записи в реляционных СУБД является документ. Документы в MongoDB  представлены в формате BSON, который является бинарным представлением JSON. Следовательно, они имеют иерархическую структуру и могут содержать не только пары "ключ-значение", но и вложенные структуры данных, такие как массивы и другие документы.
	Пример коллекции в MongoDB:
		 
Пример документа в MongoDB:
![image](https://github.com/lihofe78/WB_SQL_Home_Work/assets/56295103/81c39491-e7ab-4142-996b-9b8053814b37)

 
4. Выберите наиболее подходящие СУБД для следующих задач:  
	**- Анализ поведения знаменитостей в социальной сети.**
	Графовая СУБД
	**- Онлайн-аналитика действий пользователей на сайте онлайн магазина. Включая информацию о 	клиентах, товарах, заказах.**
Реляционная СУБД 
**- Анализ документации по фильмам и сериалам, включая: название, год выпуска, список актеров, жанр и т.д.**
		Документоориентированная СУБД
	**- Проектирование наиболее оптимальных маршрутов поставок для маркетплейса**
		Графовая СУБД.
	**- Хранение кэшированных HTML страниц пользователей, посещающих сайт**
		СУБД типа ключ-значение.

**2. DML**
1. Укажите, в каком порядке призводится написание команд при выборе данных из таблицы:
SELECT FROM WHERE GROUP BY HAVING ORDER BY LIMIT
Также укажите, в каком порядке команды выполняются при запуске отработки запроса.
**Написание команд:** SELECT FROM WHERE GROUP BY HAVING ORDER BY LIMIT

**Выполнение команд:** FROM WHERE GROUP BY HAVING SELECT ORDER BY LIMIT 
2.	 Какая команда позволит вам удалить строки таблицы по условию? Можно ли удалить таблицу с помощью данной команды?
Команда DELETE удаляет строки, но с ее помощью нельзя удалить таблицу
Для этого есть команда DROP

3.	Вам даны таблицы users, orders с информацией о пользователях и заказах. Отберите тех пользователей, кто оформлял заказы осенью 2022 года.
SELECT DISTINCT u.*
FROM users u
JOIN orders o ON u.id = o.user_id
WHERE TO_DATE(o._order_date, 'DD/MM/YYYY') BETWEEN TO_DATE('01/09/2022', 'DD/MM/YYYY') AND TO_DATE('30/11/2022', 'DD/MM/YYYY')

     	4.
	UPDATE orders
SET price = price * 0.9
WHERE user_id = (
    SELECT user_id
    FROM orders
    GROUP BY user_id
    ORDER BY SUM(price) DESC
    LIMIT 1
);

SELECT o.*, 
       CASE WHEN o.user_id = (
           SELECT user_id
           FROM orders
           GROUP BY user_id
           ORDER BY SUM(price) DESC
           LIMIT 1
       ) THEN 10 ELSE 0 END AS discount,
       o.price AS new_price
FROM orders o;

	5. 
	DELETE FROM orders
	WHERE status = 'cancelled' OR items > 4
 
6. 
SELECT SUBSTRING(email FROM POSITION('@' IN email) + 1) AS domain,
       COUNT(*) AS users_count
FROM users
WHERE gender = 'Male'
GROUP BY domain
ORDER BY users_count DESC
LIMIT 3

7. Объясните, отработает ли приведенный ниже код в СУБД PostgreSQL (и почему):
SELECT old_price - new_price AS diff 
FROM goods 
WHERE diff > 100
Нет, код не будет работать, тк мы пытаемся использовать алиас в команде WHERE, это невозможно, тк WHERE выполняется раньше, чем SELECT (в котором мы и здаем данный алиас)





